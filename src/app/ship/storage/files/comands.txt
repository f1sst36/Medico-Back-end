Switch>enable - переходим в расширенный режим 
Switch#configure terminal - переходим в режим конфигурации 
Switch(config)#vlan 2 - создаем vlan 2 
Switch(config-vlan)#name Admin - название для vlan 2 
Switch(config)#vlan 3 - создаем vlan 3 
(config-vlan)#name Server - название для vlan 3 
Switch(config)#vlan 10 - создаем vlan 10 
Switch(config-vlan)#name Users - название для vlan 10 


Switch(config)#interface range fa0/2 - fa0/4 - настраиваем интерфейсы в сторону Пользователей 
Switch(config-if-range)#description Users - описание интерфейса 
Switch(config-if-range)#switchport mode access - настраиваем порт на тегированный режим 
Switch(config-if-range)#switchport access vlan 10 - тегируем кадры 10-й VLAN 
Switch(config-if-range)#exit 
Switch(config)#interface fa0/5 - настраиваем интерфейсы в сторону Сервера 
Switch(config-if)#description Server - описание интерфейса 
Switch(config-if)#switchport mode access - настраиваем порт на тегированный режим 
Switch(config-if)#switchport access vlan 3 - тегируем кадры 3 VLAN 
Switch(config-if)#exit 
Switch(config)#interface fa0/1 - настраиваем интерфейсы в сторону Админа 
Switch(config-if)#description Admin - описание интерфейса 
Switch(config-if)#switchport mode access - настраиваем порт на тегированный режим 
Switch(config-if)#switchport access vlan 2 - тегируем кадры 2 VLAN 
Switch(config-if)#exit 
Switch(config)#interface fa0/6 - настраиваем интерфейсы в сторону маршрутизатора 
Switch(config-if)#description Router - описание интерфейса 
Switch(config-if)#switchport mode trunk - настраиваем порт на магистральный режим 
Switch(config-if)#switchport trunk allowed vlan 2,3,10 – разрешаем кадры VLAN 2-3,10 
Switch(config-if)#exit 
Switch(config)#do write - сохраняем конфигурацию


Router>enable - переходим в расширенный режим
Router#configure terminal - переходим в режим конфигурации
Router(config)#interface fa0/0 - настаиваем порт в сторону коммутатора 
Router(config-if)#description Switch - описание интерфейса 
Router(config-if)#no shutdown - включаем интерфейс физически
Router(config-if)#exit
Router(config)#interface fa0/0.2 - настраиваем подинтерфейс для подсети Админа 
Router(config-subif)#description Admin - описание интерфейса 
Router(config-subif)#encapsulation dot1q 2 - тегируем 2 VLAN'ом 
Router(config-subif)#ip address 172.16.0.1 255.255.255.0 - задаем шлюз по умолчанию для Админа Router(config-subif)#exit 
Router(config)#interface fa0/0.3 - настраиваем подинтерфейс для подсети Серверов 
Router(config-subif)#description Server - описание интерфейса 
Router(config-subif)#encapsulation dot1q 3 - тегируем 3 VLAN'ом 
Router(config-subif)#ip address 172.16.1.1 255.255.255.0 - задаем шлюз по умолчанию для Серверов 
Router(config-subif)#exit 
Router(config)#interface fa0/0.10 - настраиваем подинтерфейс для подсети пользователей 
Router(config-subif)#description Users - описание интерфейса 
Router(config-subif)#encapsulation dot1q 10 - тегируем 10 VLAN'ом 
Router(config-subif)#ip address 172.16.2.1 255.255.255.0 - задаем шлюз по умолчанию для Серверов
Router(config-subif)#exit


Router(config)#ip access-list extended Server-out - создаем расширенный список доступа 
Router(config-ext-nacl)#permit ip host 172.16.0.100 host 172.16.1.2 - даем админу полный доступ к серверу 
Router(config-ext-nacl)#permit tcp any host 172.16.1.2 eq 80 - разрешаем любому хосту доступ по HTTP к серверу 
Router(config-ext-nacl)#permit tcp any host 172.16.1.2 eq 21 - разрешаем любому хосту доступ по FTP к серверу 
Router(config-ext-nacl)#permit tcp any host 172.16.1.2 eq 53 - разрешаем любому хосту доступ по DNS к серверу 
Router(config-ext-nacl)#exit 
Router(config)#interface fa0/0.3
Router(config-if)#ip access-group Server-out out
